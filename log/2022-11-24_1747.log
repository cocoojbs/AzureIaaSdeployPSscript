**********************
PowerShell transcript start
Start time: 20221124174715
Username: JBS\kitamurat
RunAs User: JBS\kitamurat
Configuration Name: 
Machine: W1051663N211 (Microsoft Windows NT 10.0.19042.0)
Host Application: C:\Program Files\PowerShell\7\pwsh.dll
Process ID: 13680
PSVersion: 7.3.0
PSEdition: Core
GitCommitId: 7.3.0
OS: Microsoft Windows 10.0.19042
Platform: Win32NT
PSCompatibleVersions: 1.0, 2.0, 3.0, 4.0, 5.0, 5.1.10032.0, 6.0.0, 6.1.0, 6.2.0, 7.0.0, 7.1.0, 7.2.0, 7.3.0
PSRemotingProtocolVersion: 2.3
SerializationVersion: 1.1.0.1
WSManStackVersion: 3.0
**********************
Transcript started, output file is .\log\2022-11-24_1747.log
 Subscription:
HC-HC1Dept (b0da899c-406c-4ebc-b7d5-0f9286d42d1e) - cc7dee35-16af-4e40-a4d4-2619d7c0024f - kitamurat@jbs.com
|
|
|
| - - - - - - - - - - - - - -
|  VirtualNetwork
| - - - - - - - - - - - - - -
.\csv\nw_parameter.csv

vNet_name vNet_resourceGroup location  range
--------- ------------------ --------  -----
vnetweb01 rg0102             japaneast 192.168.0.0/24
vnetweb01 rg0102             japaneast 192.168.0.0/24
vnetweb01 rg0102             japaneast 192.168.0.0/24

|
| RESOURCEGROUP [ rg0102 ] deploying...
| RESOURCEGROUP_ID:
| /subscriptions/b0da899c-406c-4ebc-b7d5-0f9286d42d1e/resourceGroups/rg0102
|
| -- Azure_Virtual_Network [ vnetweb01 ] --
|
| VNET [ vnetweb01 ] deploying...
|
| VNET_ID:
| /subscriptions/b0da899c-406c-4ebc-b7d5-0f9286d42d1e/resourceGroups/rg0102/providers/Microsoft.Network/virtualNetworks/vnetweb01
|
| RESOURCEGROUP [ rg0102 ] already exists.
|
| VNET [ vnetweb01 ] already exists.
|
| RESOURCEGROUP [ rg0102 ] already exists.
|
| VNET [ vnetweb01 ] already exists.
|
| function add_VirtualNetwork completed.
|
|
|
| - - - - - - - - - - - - - -
|  NSG
| - - - - - - - - - - - - - -

vNet_name vNet_resourceGroup subnetNames       NSG_names   NSG_resourceGroups
--------- ------------------ -----------       ---------   ------------------
vnetweb01 rg0102             subnet01          nsg01       rg0102
vnetweb01 rg0102             subnet01          nsg01       rg0102
vnetweb01 rg0102             subnet02;subnet03 nsg02;nsg03 rg0102;rg0102

|
| Canceled.
|
|
|
| - - - - - - - - - - - - - -
|  Subnet
| - - - - - - - - - - - - - -

vNet_name vNet_resourceGroup subnetNames       subnetRanges                     NSG_names
--------- ------------------ -----------       ------------                     ---------
vnetweb01 rg0102             subnet01          192.168.0.0/26                   nsg01
vnetweb01 rg0102             subnet01          192.168.0.0/26                   nsg01
vnetweb01 rg0102             subnet02;subnet03 192.168.0.64/26;192.168.0.128/25 nsg02;nsg03

|
| -- Azure_Virtual_Network_Subnet [ subnet01 ] --
|
| SUBNET [ subnet01 ] deploying...

Get-AzNetworkSecurityGroup: C:\Users\kitamurat\pshome\AzureIaaSdeployPSscript\func\add_Subnet.ps1:18
Line |
  18 |  …      $nsg = Get-AzNetworkSecurityGroup -Name $nsgNames[$subnet_num] - …
     |                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     | The Resource 'Microsoft.Network/networkSecurityGroups/nsg01' under resource group 'rg0102' was not found. For more details please go to https://aka.ms/ARMResourceNotFoundFix StatusCode: 404 ReasonPhrase: Not Found ErrorCode: ResourceNotFound ErrorMessage: The Resource 'Microsoft.Network/networkSecurityGroups/nsg01' under resource group 'rg0102' was not found. For more details please go to https://aka.ms/ARMResourceNotFoundFix OperationID : 7bd6e148-a0b2-46de-85a3-ffa988107173

Get-AzNetworkSecurityGroup: C:\Users\kitamurat\pshome\AzureIaaSdeployPSscript\func\add_Subnet.ps1:18
Line |
  18 |  …      $nsg = Get-AzNetworkSecurityGroup -Name $nsgNames[$subnet_num] - …
     |                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     | The Resource 'Microsoft.Network/networkSecurityGroups/nsg01' under resource group 'rg0102' was not found. For more details please go
     | to https://aka.ms/ARMResourceNotFoundFix StatusCode: 404 ReasonPhrase: Not Found ErrorCode: ResourceNotFound ErrorMessage: The
     | Resource 'Microsoft.Network/networkSecurityGroups/nsg01' under resource group 'rg0102' was not found. For more details please go to
     | https://aka.ms/ARMResourceNotFoundFix OperationID : 7bd6e148-a0b2-46de-85a3-ffa988107173

WARNING: Upcoming breaking changes in the cmdlet 'Add-AzVirtualNetworkSubnetConfig' :
Update Property Name
Cmdlet invocation changes :
    Old Way : -ResourceId
    New Way : -NatGatewayId
Update Property Name
Cmdlet invocation changes :
    Old Way : -InputObject
    New Way : -NatGateway
Note : Go to https://aka.ms/azps-changewarnings for steps to suppress this breaking change warning, and other information on breaking changes in Azure PowerShell.
| SUBNET ResourceID:
| /subscriptions/b0da899c-406c-4ebc-b7d5-0f9286d42d1e/resourceGroups/rg0102/providers/Microsoft.Network/virtualNetworks/vnetweb01/subnets/subnet01
|
| -- Azure_Virtual_Network_Subnet [ subnet02 ] --
|
| SUBNET [ subnet02 ] deploying...

Get-AzNetworkSecurityGroup: C:\Users\kitamurat\pshome\AzureIaaSdeployPSscript\func\add_Subnet.ps1:18
Line |
  18 |  …      $nsg = Get-AzNetworkSecurityGroup -Name $nsgNames[$subnet_num] - …
     |                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     | The Resource 'Microsoft.Network/networkSecurityGroups/nsg02' under resource group 'rg0102' was not found. For more details please go to https://aka.ms/ARMResourceNotFoundFix StatusCode: 404 ReasonPhrase: Not Found ErrorCode: ResourceNotFound ErrorMessage: The Resource 'Microsoft.Network/networkSecurityGroups/nsg02' under resource group 'rg0102' was not found. For more details please go to https://aka.ms/ARMResourceNotFoundFix OperationID : ab533ecf-db33-4dbf-b6a2-b2157b201dbb

Get-AzNetworkSecurityGroup: C:\Users\kitamurat\pshome\AzureIaaSdeployPSscript\func\add_Subnet.ps1:18
Line |
  18 |  …      $nsg = Get-AzNetworkSecurityGroup -Name $nsgNames[$subnet_num] - …
     |                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     | The Resource 'Microsoft.Network/networkSecurityGroups/nsg02' under resource group 'rg0102' was not found. For more details please go
     | to https://aka.ms/ARMResourceNotFoundFix StatusCode: 404 ReasonPhrase: Not Found ErrorCode: ResourceNotFound ErrorMessage: The
     | Resource 'Microsoft.Network/networkSecurityGroups/nsg02' under resource group 'rg0102' was not found. For more details please go to
     | https://aka.ms/ARMResourceNotFoundFix OperationID : ab533ecf-db33-4dbf-b6a2-b2157b201dbb

WARNING: Upcoming breaking changes in the cmdlet 'Add-AzVirtualNetworkSubnetConfig' :
Update Property Name
Cmdlet invocation changes :
    Old Way : -ResourceId
    New Way : -NatGatewayId
Update Property Name
Cmdlet invocation changes :
    Old Way : -InputObject
    New Way : -NatGateway
Note : Go to https://aka.ms/azps-changewarnings for steps to suppress this breaking change warning, and other information on breaking changes in Azure PowerShell.
| SUBNET ResourceID:
| /subscriptions/b0da899c-406c-4ebc-b7d5-0f9286d42d1e/resourceGroups/rg0102/providers/Microsoft.Network/virtualNetworks/vnetweb01/subnets/subnet02
|
| -- Azure_Virtual_Network_Subnet [ subnet03 ] --
|
| SUBNET [ subnet03 ] deploying...

Get-AzNetworkSecurityGroup: C:\Users\kitamurat\pshome\AzureIaaSdeployPSscript\func\add_Subnet.ps1:18
Line |
  18 |  …      $nsg = Get-AzNetworkSecurityGroup -Name $nsgNames[$subnet_num] - …
     |                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     | The Resource 'Microsoft.Network/networkSecurityGroups/nsg03' under resource group 'rg0102' was not found. For more details please go to https://aka.ms/ARMResourceNotFoundFix StatusCode: 404 ReasonPhrase: Not Found ErrorCode: ResourceNotFound ErrorMessage: The Resource 'Microsoft.Network/networkSecurityGroups/nsg03' under resource group 'rg0102' was not found. For more details please go to https://aka.ms/ARMResourceNotFoundFix OperationID : fb1747d1-0dd8-4722-83a2-051bd8450c32

Get-AzNetworkSecurityGroup: C:\Users\kitamurat\pshome\AzureIaaSdeployPSscript\func\add_Subnet.ps1:18
Line |
  18 |  …      $nsg = Get-AzNetworkSecurityGroup -Name $nsgNames[$subnet_num] - …
     |                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     | The Resource 'Microsoft.Network/networkSecurityGroups/nsg03' under resource group 'rg0102' was not found. For more details please go
     | to https://aka.ms/ARMResourceNotFoundFix StatusCode: 404 ReasonPhrase: Not Found ErrorCode: ResourceNotFound ErrorMessage: The
     | Resource 'Microsoft.Network/networkSecurityGroups/nsg03' under resource group 'rg0102' was not found. For more details please go to
     | https://aka.ms/ARMResourceNotFoundFix OperationID : fb1747d1-0dd8-4722-83a2-051bd8450c32

WARNING: Upcoming breaking changes in the cmdlet 'Add-AzVirtualNetworkSubnetConfig' :
Update Property Name
Cmdlet invocation changes :
    Old Way : -ResourceId
    New Way : -NatGatewayId
Update Property Name
Cmdlet invocation changes :
    Old Way : -InputObject
    New Way : -NatGateway
Note : Go to https://aka.ms/azps-changewarnings for steps to suppress this breaking change warning, and other information on breaking changes in Azure PowerShell.
| SUBNET ResourceID:
| /subscriptions/b0da899c-406c-4ebc-b7d5-0f9286d42d1e/resourceGroups/rg0102/providers/Microsoft.Network/virtualNetworks/vnetweb01/subnets/subnet03
|
| function add_Subnet completed.
|
|
|
| - - - - - - - - - - - - - -
|  AvailabilitySet
| - - - - - - - - - - - - - -
.\csv\availability_parameter.csv

AvailabilitySet vm_resourceGroup Location  UpdateDomain FaultDomain ProximityPlacementGroup
--------------- ---------------- --------  ------------ ----------- -----------------------
asweb           rg0102           japaneast 5            2           ppgweb

|
| Canceled.
|
|
|
| - - - - - - - - - - - - - -
|  NetworkSecurityRule
| - - - - - - - - - - - - - -
.\csv\nsg_parameter.csv

nsgName nsgResourceGroup ruleName       access protocol direction priority sourceAddresses sourcePorts destAddresses
------- ---------------- --------       ------ -------- --------- -------- --------------- ----------- -------------
nsg01   rg0102           Allow80and443  allow  TCP      inbound   1000     10.0.0.0/16     *           192.168.0.0/26
nsg02   rg0102           Allow1433      allow  TCP      inbound   1000     192.168.0.0/26  *           192.168.0.64/26
nsg03   rg0102           DenyAllInbound deny   *        inbound   4096     *               *           *

|
| Canceled.
|
|
|
| - - - - - - - - - - - - - -
|  VM_NIC
| - - - - - - - - - - - - - -
.\csv\nw_parameter.csv

vm_name vNet_name subnetNames       subnetRanges                     ipAddress
------- --------- -----------       ------------                     ---------
vmweb01 vnetweb01 subnet01          192.168.0.0/26                   192.168.0.11
vmweb02 vnetweb01 subnet01          192.168.0.0/26                   192.168.0.12
vmdb01  vnetweb01 subnet02;subnet03 192.168.0.64/26;192.168.0.128/25 192.168.0.101

|
| RESOURCEGROUP [ rg0102 ] already exists.
|
| -- Azure_Virtual_Machines [ vmweb01 ] --
|
| NIC [ vmweb01-NIC1 ] deploying...
| NIC ResourceID:
| /subscriptions/b0da899c-406c-4ebc-b7d5-0f9286d42d1e/resourceGroups/rg0102/providers/Microsoft.Network/networkInterfaces/vmweb01-NIC1
|
| RESOURCEGROUP [ rg0102 ] already exists.
|
| -- Azure_Virtual_Machines [ vmweb02 ] --
|
| NIC [ vmweb02-NIC1 ] deploying...
| NIC ResourceID:
| /subscriptions/b0da899c-406c-4ebc-b7d5-0f9286d42d1e/resourceGroups/rg0102/providers/Microsoft.Network/networkInterfaces/vmweb02-NIC1
|
| RESOURCEGROUP [ rg0102 ] already exists.
|
| -- Azure_Virtual_Machines [ vmdb01 ] --
|
| NIC [ vmdb01-NIC1 ] deploying...
| NIC ResourceID:
| /subscriptions/b0da899c-406c-4ebc-b7d5-0f9286d42d1e/resourceGroups/rg0102/providers/Microsoft.Network/networkInterfaces/vmdb01-NIC1
|
| function add_NetworkInterface completed.
|
|
|
| - - - - - - - - - - - - - -
|  VM
| - - - - - - - - - - - - - -
.\csv\vm_parameter.csv

vm_name vm_resourceGroup vm_size         vmOsDisk_type vmOsDisk_size vmDataDisks_type vmDataDisks_size ImageName
------- ---------------- -------         ------------- ------------- ---------------- ---------------- ---------
vmweb01 rg0102           Standard_F2s_v2 Standard_LRS  32
vmweb02 rg0102           Standard_F2s_v2 Standard_LRS  32
vmdb01  rg0102           Standard_F2s_v2 Standard_LRS  32            StandardSSD_LRS  64               win2016-image

|
| -- Azure_Virtual_Machines [ vmweb01 ] --
|
PS>TerminatingError(Export-PSSession): "No command proxies have been created, because all of the requested remote commands would shadow existing local commands.  Use the AllowClobber parameter if you want to shadow existing local commands."
| VM [ vmweb01 ]'s OS Version infomation as follows.
Windows
MicrosoftWindowsServer
WindowsServer2019-datacenter-smalldisk-g2
| function add_VM completed.
|
|
|
| - - - - - - - - - - - - - -
|  StorageAccount
| - - - - - - - - - - - - - -
.\csv\storage_parameter.csv

storageName     storageResourceGroup location  sku          bootdiag_vmNames vmResourceGroups flowlog_nsgs nsgResourceGroups RetentionInDay
                                                                                                                             s
-----------     -------------------- --------  ---          ---------------- ---------------- ------------ ----------------- --------------
vmweb0102bootst rg0102               japaneast Standard_LRS vmweb01;vmweb02  rg0102;rg0102
vmweb0102flowst rg0102               japaneast Standard_LRS                                   nsg01        rg0102            90

|
| Canceled.
|
|
|
| - - - - - - - - - - - - - -
|  VM_Backup
| - - - - - - - - - - - - - -
.\csv\backup_parameter.csv

vmName  vmRg   RecoveryServicesName RecoveryServicesRg policyName   scheduleRunFrequency scheduleRunTimes instantRpRetentionRangeInDays cou
                                                                                                                                        nt
------  ----   -------------------- ------------------ ----------   -------------------- ---------------- ----------------------------- ---
vmweb01 rg0102 rsc01                rg0001             WeeklyPolicy Weekly               3:00             5                             1
vmdb01  rg0102 rsc01                rg0001             DailyPolicy  Daily                2:00             2                             7

|
| Canceled.
|
|
|
| COMPLETE.
|
**********************
PowerShell transcript end
End time: 20221124175032
**********************
