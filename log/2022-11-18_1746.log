**********************
Windows PowerShell トランスクリプト開始
開始時刻: 20221118174606
ユーザー名: JBS\kitamurat
RunAs ユーザー: JBS\kitamurat
構成名: 
コンピューター: W1051663N211 (Microsoft Windows NT 10.0.19042.0)
ホスト アプリケーション: powershell
プロセス ID: 11844
PSVersion: 5.1.19041.1682
PSEdition: Desktop
PSCompatibleVersions: 1.0, 2.0, 3.0, 4.0, 5.0, 5.1.19041.1682
BuildVersion: 10.0.19041.1682
CLRVersion: 4.0.30319.42000
WSManStackVersion: 3.0
PSRemotingProtocolVersion: 2.3
SerializationVersion: 1.1.0.1
**********************
トランスクリプトが開始されました。出力ファイル: .\log\2022-11-18_1746.log
 Subscription:
CP-CP2Dept (b0da899c-406c-4ebc-b7d5-0f9286d42d1e) - cc7dee35-16af-4e40-a4d4-2619d7c0024f - kitamurat@jbs.com
|
|
|
| - - - - - - - - - - - - - -
|  VirtualNetwork
| - - - - - - - - - - - - - -
.\csv\nw_parameter.csv

vNet_name vNet_resourceGroup location  range          subnetNames       subnetRanges                     NSG_names   NSG_resourceGroups
--------- ------------------ --------  -----          -----------       ------------                     ---------   ------------------
vnetweb01 rg01               japaneast 192.168.0.0/24 subnet01          192.168.0.0/26                   nsg01       rg01
vnetweb01 rg01               japaneast 192.168.0.0/24 subnet01          192.168.0.0/26                   nsg01       rg01
vnetweb01 rg01               japaneast 192.168.0.0/24 subnet02;subnet03 192.168.0.64/26;192.168.0.128/25 nsg02;nsg03 rg01;rg01


|
| Canceled.
|
|
|
| - - - - - - - - - - - - - -
|  AvailabilitySet
| - - - - - - - - - - - - - -
.\csv\availability_parameter.csv

AvailabilitySet vm_resourceGroup Location  UpdateDomain FaultDomain ProximityPlacementGroup
--------------- ---------------- --------  ------------ ----------- -----------------------
asweb           rg01             japaneast 5            2           ppgweb


|
| Canceled.
|
|
|
| - - - - - - - - - - - - - -
|  NetworkSecurityRule
| - - - - - - - - - - - - - -
.\csv\nsg_parameter.csv

nsgName nsgResourceGroup ruleName       access protocol direction priority sourceAddresses sourcePorts destAddresses
------- ---------------- --------       ------ -------- --------- -------- --------------- ----------- -------------
nsg01   rg01             Allow80and443  allow  TCP      inbound   1000     10.0.0.0/16     *           192.168.0.0/26
nsg02   rg01             Allow1433      allow  TCP      inbound   1000     192.168.0.0/26  *           192.168.0.64/26
nsg03   rg01             DenyAllInbound deny   *        inbound   4096     *               *           *


|
| Canceled.
|
|
|
| - - - - - - - - - - - - - -
|  VM_NIC
| - - - - - - - - - - - - - -
.\csv\nw_parameter.csv

vm_name vNet_name subnetNames       subnetRanges                     ipAddress
------- --------- -----------       ------------                     ---------
vmweb01 vnetweb01 subnet01          192.168.0.0/26                   192.168.0.11
vmweb02 vnetweb01 subnet01          192.168.0.0/26                   192.168.0.12
vmdb01  vnetweb01 subnet02;subnet03 192.168.0.64/26;192.168.0.128/25 192.168.0.101


|
| Canceled.
|
|
|
| - - - - - - - - - - - - - -
|  VM
| - - - - - - - - - - - - - -
.\csv\vm_parameter.csv

vm_name vm_resourceGroup vm_size         vmOsDisk_type vmOsDisk_size vmDataDisks_type vmDataDisks_size ImageName
------- ---------------- -------         ------------- ------------- ---------------- ---------------- ---------
vmweb01 rg01             Standard_F2s_v2 Standard_LRS  32
vmweb02 rg01             Standard_F2s_v2 Standard_LRS  32
vmdb01  rg01             Standard_F2s_v2 Standard_LRS  32            StandardSSD_LRS  64               win2016-image


|
| Canceled.
|
|
|
| - - - - - - - - - - - - - -
|  StorageAccount
| - - - - - - - - - - - - - -
.\csv\storage_parameter.csv

storageName     storageResourceGroup location  sku          bootdiag_vmNames vmResourceGroups flowlog_nsgs nsgResourceGroups RetentionInDays
-----------     -------------------- --------  ---          ---------------- ---------------- ------------ ----------------- ---------------
vmweb0102bootst rg01                 japaneast Standard_LRS vmweb01;vmweb02  rg01;rg01
vmweb0102flowst rg01                 japaneast Standard_LRS                                   nsg01        rg01              90


|
| -- Azure_Storage_Account [ vmweb0102bootst ] --
|
PS>終了エラー(Get-AzResourceGroup): "パラメーター 'Name の引数を確認できません。引数が null または空です。null または空でない引数を指定して、コマンドを再度実行してください。"
 RESOURCEGROUP [  ] deploy failed.
|
PS>終了エラー(Invoke-WebRequest): "リモート名を解決できませんでした。: 'vmweb0102bootst.blob.core.windows.net'"
| STORAGE [ vmweb0102bootst ] deploying...
| STORAGE ResourceID:
/subscriptions/b0da899c-406c-4ebc-b7d5-0f9286d42d1e/resourceGroups/rg01/providers/Microsoft.Storage/storageAccounts/vmweb0102bootst
|
| -- Set-AzVMBootDiagnostic [ vmweb01 ] with Custom Storage Account --
|

| BootDiagnosticSettings:

ResourceGroupName        : rg01
Id                       : /subscriptions/b0da899c-406c-4ebc-b7d5-0f9286d42d1e/resourceGroups/rg01/providers/Microsoft.Compute/virtualMachines/vmweb01
VmId                     : 075d9fbe-e893-4e8f-804d-5395d20e7857
Name                     : vmweb01
Type                     : Microsoft.Compute/virtualMachines
Location                 : japaneast
Tags                     : {"Owner":"kitamurat@jbs.com"}
AvailabilitySetReference : {Id}
DiagnosticsProfile       : {BootDiagnostics}
HardwareProfile          : {VmSize}
NetworkProfile           : {NetworkInterfaces}
OSProfile                : {ComputerName, AdminUsername, WindowsConfiguration, Secrets, AllowExtensionOperations, RequireGuestProvisionSignal}
ProvisioningState        : Succeeded
StorageProfile           : {ImageReference, OsDisk, DataDisks}
ProximityPlacementGroup  : {Id}


Enabled    : True
StorageUri : https://vmweb0102bootst.blob.core.windows.net/

|
| -- Set-AzVMBootDiagnostic [ vmweb02 ] with Custom Storage Account --
|

ResourceGroupName        : rg01
Id                       : /subscriptions/b0da899c-406c-4ebc-b7d5-0f9286d42d1e/resourceGroups/rg01/providers/Microsoft.Compute/virtualMachines/vmweb02
VmId                     : 5d007002-b5ef-4f83-87d5-fd0263739b24
Name                     : vmweb02
Type                     : Microsoft.Compute/virtualMachines
Location                 : japaneast
Tags                     : {"Owner":"kitamurat@jbs.com"}
AvailabilitySetReference : {Id}
DiagnosticsProfile       : {BootDiagnostics}
HardwareProfile          : {VmSize}
NetworkProfile           : {NetworkInterfaces}
OSProfile                : {ComputerName, AdminUsername, WindowsConfiguration, Secrets, AllowExtensionOperations, RequireGuestProvisionSignal}
ProvisioningState        : Succeeded
StorageProfile           : {ImageReference, OsDisk, DataDisks}
ProximityPlacementGroup  : {Id}

| BootDiagnosticSettings:

Enabled    : True
StorageUri : https://vmweb0102bootst.blob.core.windows.net/

|
| -- Azure_Storage_Account [ vmweb0102flowst ] --
|
PS>終了エラー(Get-AzResourceGroup): "パラメーター 'Name の引数を確認できません。引数が null または空です。null または空でない引数を指定して、コマンドを再度実行してください。"
 RESOURCEGROUP [  ] deploy failed.
|
PS>終了エラー(Invoke-WebRequest): "リモート名を解決できませんでした。: 'vmweb0102flowst.blob.core.windows.net'"
| STORAGE [ vmweb0102flowst ] deploying...
| STORAGE ResourceID:
/subscriptions/b0da899c-406c-4ebc-b7d5-0f9286d42d1e/resourceGroups/rg01/providers/Microsoft.Storage/storageAccounts/vmweb0102flowst
|
| -- Set-AzNetworkWatcherConfigFlowLog [nsg01] --
|
| FlowLogSettings:

Enabled                        : True
RetentionPolicy                : Microsoft.Azure.Commands.Network.Models.PSRetentionPolicyParameters
Format                         : Microsoft.Azure.Commands.Network.Models.PSFlowLogFormatParameters
StorageId                      : /subscriptions/b0da899c-406c-4ebc-b7d5-0f9286d42d1e/resourceGroups/rg01/providers/Microsoft.Storage/storageAccounts/vmweb0102flowst
TargetResourceId               : /subscriptions/b0da899c-406c-4ebc-b7d5-0f9286d42d1e/resourceGroups/rg01/providers/Microsoft.Network/networkSecurityGroups/nsg01
FlowAnalyticsConfiguration     : Microsoft.Azure.Commands.Network.Models.PSTrafficAnalyticsProperties
RetentionPolicyText            : {
                                   "Days": 90,
                                   "Enabled": true
                                 }
FormatText                     : {
                                   "Type": "JSON",
                                   "Version": 2
                                 }
FlowAnalyticsConfigurationText : {}

|
| function add_StorageAccount completed.
|
|
|
| - - - - - - - - - - - - - -
|  VM_Backup
| - - - - - - - - - - - - - -
.\csv\backup_parameter.csv



vmName  vmRg RecoveryServicesName RecoveryServicesRg policyName   scheduleRunFrequency scheduleRunTimes instantRpRetentionRangeInDays count weeklySchedule
------  ---- -------------------- ------------------ ----------   -------------------- ---------------- ----------------------------- ----- --------------
vmweb01 rg01 rsc01                rg01               WeeklyPolicy Weekly               3:00             5                             1     Sunday
vmdb01  rg01 rsc01                rg01               DailyPolicy  Daily                2:00             2                             7


|
| -- Azure_Backup [ rsc01 ] --
|
| RESOURCEGROUP_ID:
/subscriptions/b0da899c-406c-4ebc-b7d5-0f9286d42d1e/resourceGroups/rg01
|
| RecoveryServicesVault [ rsc01 ] deploying...

| RSC ResourceID:

Name              : rsc01
ID                : /subscriptions/b0da899c-406c-4ebc-b7d5-0f9286d42d1e/resourceGroups/rg01/providers/Microsoft.RecoveryServices/vaults/rsc01
Type              : Microsoft.RecoveryServices/vaults
Location          : japaneast
ResourceGroupName : rg01
SubscriptionId    : b0da899c-406c-4ebc-b7d5-0f9286d42d1e
Properties        : Microsoft.Azure.Commands.RecoveryServices.ARSVaultProperties
Identity          :

/subscriptions/b0da899c-406c-4ebc-b7d5-0f9286d42d1e/resourceGroups/rg01/providers/Microsoft.RecoveryServices/vaults/rsc01
|
| -- Azure_Backup_BackupPolicy [ WeeklyPolicy ] in [ rsc01 ] --
|
| BackupPolicy [ WeeklyPolicy ] deploying...
ResourceGroupName       : rg01
OnErrorDeployment       :
DeploymentName          : template_bkpol
CorrelationId           : c86836e3-2327-4f8c-ad92-ae56d44070f1
ProvisioningState       : Succeeded
Timestamp               : 2022/11/18 8:50:29
Mode                    : Incremental
TemplateLink            :
TemplateLinkString      :
DeploymentDebugLogLevel :
Parameters              : {[vaultName,
                          Type        Value
                          ----------  ----------
                          String      rsc01
                          ], [vaultRG,
                          Type        Value
                          ----------  ----------
                          String
                          ], [vaultSubID,
                          Type        Value
                          ----------  ----------
                          String
                          ], [instantRpRetentionRangeInDays,
                          Type        Value
                          ----------  ----------
                          Int         5
                          ]...}
Tags                    :
ParametersString        :
                          Name                             Type                       Value
                          ===============================  =========================  ==========
                          vaultName                        String                     "rsc01"
                          vaultRG                          String                     ""
                          vaultSubID                       String                     ""
                          instantRpRetentionRangeInDays    Int                        5
                          policyName                       String                     "WeeklyPolicy"
                          schedule                         Object                     {"scheduleRunFrequency":"Weekly","scheduleRunDays":["Sunday"],"scheduleRunTimes":["2022-11-18
                          T03:00:00Z"],"schedulePolicyType":"SimpleSchedulePolicy"}
                          retention                        Object                     {"dailySchedule":null,"weeklySchedule":{"daysOfTheWeek":["Sunday"],"retentionTimes":["2022-11
                          -18T03:00:00Z"],"retentionDuration":{"count":1,"durationType":"Weeks"}},"monthlySchedule":null,"yearlySchedule":null,"retentionPolicyType":"LongTermReten
                          tionPolicy"}
                          timeZone                         String                     "Tokyo Standard Time"
                          instantRPDetails                 Object                     {}

Outputs                 :
OutputsString           :

|
PS>終了エラー(Write-Host): "引数 '+' を受け入れる位置指定パラメーターが見つかりません。"
>> 終了エラー(Write-Host): "引数 '+' を受け入れる位置指定パラメーターが見つかりません。"
>> 終了エラー(Write-Host): "引数 '+' を受け入れる位置指定パラメーターが見つかりません。"
>> 終了エラー(Write-Host): "引数 '+' を受け入れる位置指定パラメーターが見つかりません。"
>> 終了エラー(Write-Host): "引数 '+' を受け入れる位置指定パラメーターが見つかりません。"
引数 '+' を受け入れる位置指定パラメーターが見つかりません。
Write-Host : 引数 '+' を受け入れる位置指定パラメーターが見つかりません。
発生場所 C:\Users\kitamurat\pshome\AzureIaaSdeployPSscript\func\add_AzRecoveryServicesVault.ps1:111 文字:9
+         Write-Host -Object "| Current BackupRedundancy [ " + $RSC_Red ...
+         ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : InvalidArgument: (:) [Write-Host]、ParentContainsErrorRecordException
    + FullyQualifiedErrorId : PositionalParameterNotFound,Microsoft.PowerShell.Commands.WriteHostCommand

PS \AzureIaaSdeployPSscript>
PS \AzureIaaSdeployPSscript>
PS \AzureIaaSdeployPSscript>
PS \AzureIaaSdeployPSscript>
PS \AzureIaaSdeployPSscript>
PS>.\deploy_AzVm.ps1
トランスクリプトが開始されました。出力ファイル: .\log\2022-11-18_1755.log
 Subscription:
CP-CP2Dept (b0da899c-406c-4ebc-b7d5-0f9286d42d1e) - cc7dee35-16af-4e40-a4d4-2619d7c0024f - kitamurat@jbs.com
|
|
|
| - - - - - - - - - - - - - -
|  VirtualNetwork
| - - - - - - - - - - - - - -
.\csv\nw_parameter.csv

vNet_name vNet_resourceGroup location  range          subnetNames       subnetRanges                     NSG_names   NSG_resourceGroups
--------- ------------------ --------  -----          -----------       ------------                     ---------   ------------------
vnetweb01 rg01               japaneast 192.168.0.0/24 subnet01          192.168.0.0/26                   nsg01       rg01
vnetweb01 rg01               japaneast 192.168.0.0/24 subnet01          192.168.0.0/26                   nsg01       rg01
vnetweb01 rg01               japaneast 192.168.0.0/24 subnet02;subnet03 192.168.0.64/26;192.168.0.128/25 nsg02;nsg03 rg01;rg01


|
| Canceled.
|
|
|
| - - - - - - - - - - - - - -
|  AvailabilitySet
| - - - - - - - - - - - - - -
.\csv\availability_parameter.csv

AvailabilitySet vm_resourceGroup Location  UpdateDomain FaultDomain ProximityPlacementGroup
--------------- ---------------- --------  ------------ ----------- -----------------------
asweb           rg01             japaneast 5            2           ppgweb


|
| Canceled.
|
|
|
| - - - - - - - - - - - - - -
|  NetworkSecurityRule
| - - - - - - - - - - - - - -
.\csv\nsg_parameter.csv

nsgName nsgResourceGroup ruleName       access protocol direction priority sourceAddresses sourcePorts destAddresses
------- ---------------- --------       ------ -------- --------- -------- --------------- ----------- -------------
nsg01   rg01             Allow80and443  allow  TCP      inbound   1000     10.0.0.0/16     *           192.168.0.0/26
nsg02   rg01             Allow1433      allow  TCP      inbound   1000     192.168.0.0/26  *           192.168.0.64/26
nsg03   rg01             DenyAllInbound deny   *        inbound   4096     *               *           *


|
| Canceled.
|
|
|
| - - - - - - - - - - - - - -
|  VM_NIC
| - - - - - - - - - - - - - -
.\csv\nw_parameter.csv

vm_name vNet_name subnetNames       subnetRanges                     ipAddress
------- --------- -----------       ------------                     ---------
vmweb01 vnetweb01 subnet01          192.168.0.0/26                   192.168.0.11
vmweb02 vnetweb01 subnet01          192.168.0.0/26                   192.168.0.12
vmdb01  vnetweb01 subnet02;subnet03 192.168.0.64/26;192.168.0.128/25 192.168.0.101


|
| Canceled.
|
|
|
| - - - - - - - - - - - - - -
|  VM
| - - - - - - - - - - - - - -
.\csv\vm_parameter.csv

vm_name vm_resourceGroup vm_size         vmOsDisk_type vmOsDisk_size vmDataDisks_type vmDataDisks_size ImageName
------- ---------------- -------         ------------- ------------- ---------------- ---------------- ---------
vmweb01 rg01             Standard_F2s_v2 Standard_LRS  32
vmweb02 rg01             Standard_F2s_v2 Standard_LRS  32
vmdb01  rg01             Standard_F2s_v2 Standard_LRS  32            StandardSSD_LRS  64               win2016-image


|
| Canceled.
|
|
|
| - - - - - - - - - - - - - -
|  StorageAccount
| - - - - - - - - - - - - - -
.\csv\storage_parameter.csv

storageName     storageResourceGroup location  sku          bootdiag_vmNames vmResourceGroups flowlog_nsgs nsgResourceGroups RetentionInDays
-----------     -------------------- --------  ---          ---------------- ---------------- ------------ ----------------- ---------------
vmweb0102bootst rg01                 japaneast Standard_LRS vmweb01;vmweb02  rg01;rg01
vmweb0102flowst rg01                 japaneast Standard_LRS                                   nsg01        rg01              90


|
| Canceled.
|
|
|
| - - - - - - - - - - - - - -
|  VM_Backup
| - - - - - - - - - - - - - -
.\csv\backup_parameter.csv

vmName  vmRg RecoveryServicesName RecoveryServicesRg policyName   scheduleRunFrequency scheduleRunTimes instantRpRetentionRangeInDays count weeklySchedule
------  ---- -------------------- ------------------ ----------   -------------------- ---------------- ----------------------------- ----- --------------
vmweb01 rg01 rsc01                rg01               WeeklyPolicy Weekly               3:00             5                             1     Sunday
vmdb01  rg01 rsc01                rg01               DailyPolicy  Daily                2:00             2                             7


|
| -- Azure_Backup [ rsc01 ] --
|
| RESOURCEGROUP_ID:
/subscriptions/b0da899c-406c-4ebc-b7d5-0f9286d42d1e/resourceGroups/rg01
|
| RSC ResourceID:
/subscriptions/b0da899c-406c-4ebc-b7d5-0f9286d42d1e/resourceGroups/rg01/providers/Microsoft.RecoveryServices/vaults/rsc01
|
| -- Azure_Backup_BackupPolicy [ WeeklyPolicy ] in [ rsc01 ] --
|
| Current BackupRedundancy [ Microsoft.Azure.Commands.RecoveryServices.ASRVaultBackupProperties.BackupStorageRedundancy ]
|
| Changing BackupRedundancy...
| Current BackupRedundancy [ Microsoft.Azure.Commands.RecoveryServices.ASRVaultBackupProperties.BackupStorageRedundancy ]
|

| Enable-AzRecoveryServicesBackupProtection...Success.
| VM [ vmweb01 ] Backup Settings Enabled.
|
| -- Azure_Backup [ rsc01 ] --
|
[ERROR] VM [ vmdb01 ] not found.
| function add_AzRecoveryServicesVault complete.
|
|
|
| COMPLETE.
|
WorkloadName Operation       Status    StartTime          EndTime            JobID
------------ ---------       ------    ---------          -------            -----
vmweb01      ConfigureBackup Completed 2022/11/18 8:55:54 2022/11/18 8:56:35 fb1bee67-cc9c-4631-a1a6-fe50756f1eef
トランスクリプトが停止されました。出力ファイル: C:\Users\kitamurat\pshome\AzureIaaSdeployPSscript\log\2022-11-18_1755.log


PS \AzureIaaSdeployPSscript>
PS>$rsc_name = rsc01
rsc01 : 用語 'rsc01' は、コマンドレット、関数、スクリプト ファイル、または操作可能なプログラムの名前として認識されません。名前が正しく記述されていることを確認し、パスが含まれている場合はそのパスが正しいことを確認してから、
再試行してください。
発生場所 行:1 文字:13
+ $rsc_name = rsc01
+             ~~~~~
    + CategoryInfo          : ObjectNotFound: (rsc01:String) [], CommandNotFoundException
    + FullyQualifiedErrorId : CommandNotFoundException
rsc01 : 用語 'rsc01' は、コマンドレット、関数、スクリプト ファイル、または操作可能なプログラムの名前として認識されません。名前が正しく記述されていることを確認し、パスが含まれてい
る場合はそのパスが正しいことを確認してから、再試行してください。
発生場所 行:1 文字:13
+ $rsc_name = rsc01
+             ~~~~~
    + CategoryInfo          : ObjectNotFound: (rsc01:String) [], CommandNotFoundException
    + FullyQualifiedErrorId : CommandNotFoundException

PS \AzureIaaSdeployPSscript>
PS \AzureIaaSdeployPSscript>
PS \AzureIaaSdeployPSscript>
PS>$rsc_name = "rsc01"
PS \AzureIaaSdeployPSscript>
PS \AzureIaaSdeployPSscript>
PS \AzureIaaSdeployPSscript>
PS>$rsc_rg = "rg01"
PS \AzureIaaSdeployPSscript>
PS \AzureIaaSdeployPSscript>
PS \AzureIaaSdeployPSscript>
PS \AzureIaaSdeployPSscript>
PS>        $vault = Get-AzRecoveryServicesVault -Name $rsc_name -ResourceGroupName $rsc_rg
PS \AzureIaaSdeployPSscript>
PS>        $RSC_Redundancy = (Get-AzRecoveryServicesBackupProperties -Vault $vault -ErrorAction SilentlyContinue
).BackupStorageRedundancy
PS \AzureIaaSdeployPSscript>
PS \AzureIaaSdeployPSscript>
PS \AzureIaaSdeployPSscript>
PS \AzureIaaSdeployPSscript>
PS \AzureIaaSdeployPSscript>
PS>$vault


Name              : rsc01
ID                : /subscriptions/b0da899c-406c-4ebc-b7d5-0f9286d42d1e/resourceGroups/rg01/providers/Microsoft.RecoveryServices/vaults/rsc01
Type              : Microsoft.RecoveryServices/vaults
Location          : japaneast
ResourceGroupName : rg01
SubscriptionId    : b0da899c-406c-4ebc-b7d5-0f9286d42d1e
Properties        : Microsoft.Azure.Commands.RecoveryServices.ARSVaultProperties
Identity          :



PS \AzureIaaSdeployPSscript>
PS \AzureIaaSdeployPSscript>
PS \AzureIaaSdeployPSscript>
PS \AzureIaaSdeployPSscript>
PS>        $RSC_Redundancy = Get-AzRecoveryServicesBackupProperties -Vault $vault -ErrorAction SilentlyContinue
PS \AzureIaaSdeployPSscript>
PS \AzureIaaSdeployPSscript>
PS \AzureIaaSdeployPSscript>
PS \AzureIaaSdeployPSscript>
PS \AzureIaaSdeployPSscript>
PS>$RSC_Redundancy

BackupStorageRedundancy CrossRegionRestore
----------------------- ------------------
LocallyRedundant                     False


PS \AzureIaaSdeployPSscript>
PS>        $RSC_Redundancy = (Get-AzRecoveryServicesBackupProperties -Vault $vault).backupstorageredundancy -ErrorAction SilentlyContinue
発生場所 行:1 文字:106
+ ... roperties -Vault $vault).backupstorageredundancy -ErrorAction Silentl ...
+                                                      ~~~~~~~~~~~~
式またはステートメントのトークン '-ErrorAction' を使用できません。

発生場所 行:1 文字:119
+ ...  -Vault $vault).backupstorageredundancy -ErrorAction SilentlyContinue
+                                                          ~~~~~~~~~~~~~~~~
式またはステートメントのトークン 'SilentlyContinue' を使用できません。
発生場所 行:1 文字:106
+ ... roperties -Vault $vault).backupstorageredundancy -ErrorAction Silentl ...
+                                                      ~~~~~~~~~~~~
式またはステートメントのトークン '-ErrorAction' を使用できません。

発生場所 行:1 文字:119
+ ...  -Vault $vault).backupstorageredundancy -ErrorAction SilentlyContinue
+                                                          ~~~~~~~~~~~~~~~~
式またはステートメントのトークン 'SilentlyContinue' を使用できません。
    + CategoryInfo          : ParserError: (:) [], ParentContainsErrorRecordException
    + FullyQualifiedErrorId : UnexpectedToken

PS \AzureIaaSdeployPSscript>
PS \AzureIaaSdeployPSscript>
PS \AzureIaaSdeployPSscript>
PS \AzureIaaSdeployPSscript>
PS>        $RSC_Redundancy = (Get-AzRecoveryServicesBackupProperties -Vault $vault).backupstorageredundancy
PS \AzureIaaSdeployPSscript>
PS \AzureIaaSdeployPSscript>
PS \AzureIaaSdeployPSscript>
PS \AzureIaaSdeployPSscript>
PS>$RSC_Redundancy
LocallyRedundant
PS \AzureIaaSdeployPSscript>
PS>                $Redundancy_type = (Get-AzRecoveryServicesBackupProperties -Vault $vault).BackupStorageRedundancy
PS \AzureIaaSdeployPSscript>
PS \AzureIaaSdeployPSscript>
PS \AzureIaaSdeployPSscript>
PS \AzureIaaSdeployPSscript>
PS \AzureIaaSdeployPSscript>
PS>$Redundancy_type
LocallyRedundant
PS \AzureIaaSdeployPSscript>
PS \AzureIaaSdeployPSscript>
PS \AzureIaaSdeployPSscript>
PS \AzureIaaSdeployPSscript>
PS \AzureIaaSdeployPSscript>
PS \AzureIaaSdeployPSscript>
PS \AzureIaaSdeployPSscript>
PS \AzureIaaSdeployPSscript>
PS>.\deploy_AzVm.ps1
トランスクリプトが開始されました。出力ファイル: .\log\2022-11-18_1811.log
 Subscription:
CP-CP2Dept (b0da899c-406c-4ebc-b7d5-0f9286d42d1e) - cc7dee35-16af-4e40-a4d4-2619d7c0024f - kitamurat@jbs.com
|
|
|
| - - - - - - - - - - - - - -
|  VirtualNetwork
| - - - - - - - - - - - - - -
.\csv\nw_parameter.csv

vNet_name vNet_resourceGroup location  range          subnetNames       subnetRanges                     NSG_names   NSG_resourceGroups
--------- ------------------ --------  -----          -----------       ------------                     ---------   ------------------
vnetweb01 rg01               japaneast 192.168.0.0/24 subnet01          192.168.0.0/26                   nsg01       rg01
vnetweb01 rg01               japaneast 192.168.0.0/24 subnet01          192.168.0.0/26                   nsg01       rg01
vnetweb01 rg01               japaneast 192.168.0.0/24 subnet02;subnet03 192.168.0.64/26;192.168.0.128/25 nsg02;nsg03 rg01;rg01


|
| Canceled.
|
|
|
| - - - - - - - - - - - - - -
|  AvailabilitySet
| - - - - - - - - - - - - - -
.\csv\availability_parameter.csv

AvailabilitySet vm_resourceGroup Location  UpdateDomain FaultDomain ProximityPlacementGroup
--------------- ---------------- --------  ------------ ----------- -----------------------
asweb           rg01             japaneast 5            2           ppgweb


|
| Canceled.
|
|
|
| - - - - - - - - - - - - - -
|  NetworkSecurityRule
| - - - - - - - - - - - - - -
.\csv\nsg_parameter.csv

nsgName nsgResourceGroup ruleName       access protocol direction priority sourceAddresses sourcePorts destAddresses
------- ---------------- --------       ------ -------- --------- -------- --------------- ----------- -------------
nsg01   rg01             Allow80and443  allow  TCP      inbound   1000     10.0.0.0/16     *           192.168.0.0/26
nsg02   rg01             Allow1433      allow  TCP      inbound   1000     192.168.0.0/26  *           192.168.0.64/26
nsg03   rg01             DenyAllInbound deny   *        inbound   4096     *               *           *


|
| Canceled.
|
|
|
| - - - - - - - - - - - - - -
|  VM_NIC
| - - - - - - - - - - - - - -
.\csv\nw_parameter.csv

vm_name vNet_name subnetNames       subnetRanges                     ipAddress
------- --------- -----------       ------------                     ---------
vmweb01 vnetweb01 subnet01          192.168.0.0/26                   192.168.0.11
vmweb02 vnetweb01 subnet01          192.168.0.0/26                   192.168.0.12
vmdb01  vnetweb01 subnet02;subnet03 192.168.0.64/26;192.168.0.128/25 192.168.0.101


|
| Canceled.
|
|
|
| - - - - - - - - - - - - - -
|  VM
| - - - - - - - - - - - - - -
.\csv\vm_parameter.csv

vm_name vm_resourceGroup vm_size         vmOsDisk_type vmOsDisk_size vmDataDisks_type vmDataDisks_size ImageName
------- ---------------- -------         ------------- ------------- ---------------- ---------------- ---------
vmweb01 rg01             Standard_F2s_v2 Standard_LRS  32
vmweb02 rg01             Standard_F2s_v2 Standard_LRS  32
vmdb01  rg01             Standard_F2s_v2 Standard_LRS  32            StandardSSD_LRS  64               win2016-image


|
| Canceled.
|
|
|
| - - - - - - - - - - - - - -
|  StorageAccount
| - - - - - - - - - - - - - -
.\csv\storage_parameter.csv

storageName     storageResourceGroup location  sku          bootdiag_vmNames vmResourceGroups flowlog_nsgs nsgResourceGroups RetentionInDays
-----------     -------------------- --------  ---          ---------------- ---------------- ------------ ----------------- ---------------
vmweb0102bootst rg01                 japaneast Standard_LRS vmweb01;vmweb02  rg01;rg01
vmweb0102flowst rg01                 japaneast Standard_LRS                                   nsg01        rg01              90


|
| Canceled.
|
|
|
| - - - - - - - - - - - - - -
|  VM_Backup
| - - - - - - - - - - - - - -
.\csv\backup_parameter.csv

vmName  vmRg RecoveryServicesName RecoveryServicesRg policyName   scheduleRunFrequency scheduleRunTimes instantRpRetentionRangeInDays count weeklySchedule
------  ---- -------------------- ------------------ ----------   -------------------- ---------------- ----------------------------- ----- --------------
vmweb01 rg01 rsc01                rg01               WeeklyPolicy Weekly               3:00             5                             1     Sunday
vmdb01  rg01 rsc01                rg01               DailyPolicy  Daily                2:00             2                             7


|
| -- Azure_Backup [ rsc01 ] --
|
| RESOURCEGROUP_ID:
/subscriptions/b0da899c-406c-4ebc-b7d5-0f9286d42d1e/resourceGroups/rg01
|
| RSC ResourceID:
/subscriptions/b0da899c-406c-4ebc-b7d5-0f9286d42d1e/resourceGroups/rg01/providers/Microsoft.RecoveryServices/vaults/rsc01
|
| -- Azure_Backup_BackupPolicy [ WeeklyPolicy ] in [ rsc01 ] --
|
| Current BackupRedundancy [ LocallyRedundant ]
|
| BackupProtection is already Enabled.
| VM [ vmweb01 ] Backup Settings Enabled.
|
| -- Azure_Backup [ rsc01 ] --
|
[ERROR] VM [ vmdb01 ] not found.
| function add_AzRecoveryServicesVault complete.
|
|
|
| COMPLETE.
|
トランスクリプトが停止されました。出力ファイル: C:\Users\kitamurat\pshome\AzureIaaSdeployPSscript\log\2022-11-18_1811.log
PS \AzureIaaSdeployPSscript>
PS \AzureIaaSdeployPSscript>
PS \AzureIaaSdeployPSscript>
PS \AzureIaaSdeployPSscript>
PS \AzureIaaSdeployPSscript>
PS>exit
**********************
Windows PowerShell トランスクリプト終了
終了時刻: 20221118190116
**********************
